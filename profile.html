<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mi Perfil - Galaxia Magna Academy</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>

<body>

  <!-- HEADER -->
  <header>
    <img src="images/GAM_transparent.png" alt="Galaxia Magna Academy Logo" style="width: 80px; height: 80px; object-fit: contain;">
    <div class="header-text">
      <h1>Mi Perfil</h1>
      <h2 style="font-size: 1.5em;">Galaxia Magna Academy</h2>
    </div>
    <img src="images/GAM_transparent.png" alt="GMA Logo" style="width: 80px; height: 80px; object-fit: contain;">
  </header>

  <main>
    <!-- Navigation -->
    <nav class="profile-nav">
      <ul>
        <li><a href="index.html">← Volver al Inicio</a></li>
        <li><a href="registro.html">Formulario de Registro</a></li>
      </ul>
    </nav>

    <!-- Message Area -->
    <div id="message-area" style="display: none; max-width: 800px; margin: 20px auto; padding: 15px; border-radius: 8px; text-align: center; font-weight: bold;"></div>

    <!-- User Profile Section -->
    <section style="max-width: 800px; margin: 40px auto; padding: 40px 20px; background: #23232b; border-radius: 12px; box-shadow: 0 4px 24px #0008; color: #fff;">
      
      <!-- Profile Header -->
      <div style="text-align: center; margin-bottom: 30px;">
        <div id="avatar-container" style="margin-bottom: 20px;">
          <img id="user-avatar" src="images/Male.png" alt="Avatar" style="width: 120px; height: 120px; border-radius: 50%; border: 4px solid #f18b32; object-fit: cover;">
        </div>
        <h2 id="user-display-name" style="color: #f18b32; margin-bottom: 10px;">Cargando...</h2>
        <p id="user-role" style="color: #c9c9c9; margin-bottom: 0;">Rol: Cargando...</p>
        <p id="user-code" style="color: #c9c9c9; font-size: 0.9em;">Código: Cargando...</p>
      </div>

      <!-- Profile Information -->
      <div class="profile-info">
        
        <!-- Name Field -->
        <div class="profile-field" style="margin-bottom: 25px; padding: 20px; background: #2d2d35; border-radius: 8px; position: relative;">
          <label style="color: #f18b32; font-weight: bold; display: block; margin-bottom: 8px;">
            <i class="fas fa-user" style="margin-right: 8px;"></i>Nombre Completo
          </label>
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <span id="name-display" style="color: #fff; font-size: 1.1em;">Cargando...</span>
            <i class="fas fa-pen edit-icon" onclick="editField('name')" style="color: #f18b32; cursor: pointer; font-size: 1.2em;" title="Editar nombre"></i>
          </div>
          <input type="text" id="name-edit" style="display: none; width: 100%; padding: 8px; margin-top: 10px; border: 1px solid #4a4a55; border-radius: 4px; background: #1a1a1f; color: #fff;">
          <div style="display: none; margin-top: 10px;" id="name-buttons">
            <button onclick="saveField('name')" style="background: #22c55e; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin-right: 10px; cursor: pointer;">Guardar</button>
            <button onclick="cancelEdit('name')" style="background: #ef4444; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Cancelar</button>
          </div>
        </div>

        <!-- Email Field -->
        <div class="profile-field" style="margin-bottom: 25px; padding: 20px; background: #2d2d35; border-radius: 8px; position: relative;">
          <label style="color: #f18b32; font-weight: bold; display: block; margin-bottom: 8px;">
            <i class="fas fa-envelope" style="margin-right: 8px;"></i>Email
          </label>
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <span id="email-display" style="color: #fff; font-size: 1.1em;">Cargando...</span>
            <i class="fas fa-pen edit-icon" onclick="editField('email')" style="color: #f18b32; cursor: pointer; font-size: 1.2em;" title="Editar email"></i>
          </div>
          <input type="email" id="email-edit" style="display: none; width: 100%; padding: 8px; margin-top: 10px; border: 1px solid #4a4a55; border-radius: 4px; background: #1a1a1f; color: #fff;">
          <div style="display: none; margin-top: 10px;" id="email-buttons">
            <button onclick="saveField('email')" style="background: #22c55e; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin-right: 10px; cursor: pointer;">Guardar</button>
            <button onclick="cancelEdit('email')" style="background: #ef4444; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Cancelar</button>
          </div>
        </div>

        <!-- Phone Field -->
        <div class="profile-field" style="margin-bottom: 25px; padding: 20px; background: #2d2d35; border-radius: 8px; position: relative;">
          <label style="color: #f18b32; font-weight: bold; display: block; margin-bottom: 8px;">
            <i class="fas fa-phone" style="margin-right: 8px;"></i>Teléfono
          </label>
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <span id="telefono-display" style="color: #fff; font-size: 1.1em;">Cargando...</span>
            <i class="fas fa-pen edit-icon" onclick="editField('telefono')" style="color: #f18b32; cursor: pointer; font-size: 1.2em;" title="Editar teléfono"></i>
          </div>
          <input type="tel" id="telefono-edit" style="display: none; width: 100%; padding: 8px; margin-top: 10px; border: 1px solid #4a4a55; border-radius: 4px; background: #1a1a1f; color: #fff;">
          <div style="display: none; margin-top: 10px;" id="telefono-buttons">
            <button onclick="saveField('telefono')" style="background: #22c55e; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin-right: 10px; cursor: pointer;">Guardar</button>
            <button onclick="cancelEdit('telefono')" style="background: #ef4444; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Cancelar</button>
          </div>
        </div>

        <!-- Gender Field -->
        <div class="profile-field" style="margin-bottom: 25px; padding: 20px; background: #2d2d35; border-radius: 8px; position: relative;">
          <label style="color: #f18b32; font-weight: bold; display: block; margin-bottom: 8px;">
            <i class="fas fa-venus-mars" style="margin-right: 8px;"></i>Género
          </label>
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <span id="genero-display" style="color: #fff; font-size: 1.1em;">Cargando...</span>
            <i class="fas fa-pen edit-icon" onclick="editField('genero')" style="color: #f18b32; cursor: pointer; font-size: 1.2em;" title="Editar género"></i>
          </div>
          <select id="genero-edit" style="display: none; width: 100%; padding: 8px; margin-top: 10px; border: 1px solid #4a4a55; border-radius: 4px; background: #1a1a1f; color: #fff;">
            <option value="m">Masculino</option>
            <option value="f">Femenino</option>
            <option value="o">Otro</option>
            <option value="n">Prefiero no decir</option>
          </select>
          <div style="display: none; margin-top: 10px;" id="genero-buttons">
            <button onclick="saveField('genero')" style="background: #22c55e; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin-right: 10px; cursor: pointer;">Guardar</button>
            <button onclick="cancelEdit('genero')" style="background: #ef4444; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Cancelar</button>
          </div>
        </div>

        <!-- Interests Field -->
        <div class="profile-field" style="margin-bottom: 25px; padding: 20px; background: #2d2d35; border-radius: 8px; position: relative;">
          <label style="color: #f18b32; font-weight: bold; display: block; margin-bottom: 8px;">
            <i class="fas fa-heart" style="margin-right: 8px;"></i>Club
          </label>
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <span id="intereses-display" style="color: #fff; font-size: 1.1em;">Cargando...</span>
            <i class="fas fa-pen edit-icon" onclick="editField('intereses')" style="color: #f18b32; cursor: pointer; font-size: 1.2em;" title="Editar club"></i>
          </div>
          <div id="intereses-edit" style="display: none; margin-top: 15px;">
            <select id="intereses-input" style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 1em;">
              <option value="ajedrez">Club de Ajedrez</option>
              <option value="arte">Club de Arte</option>
              <option value="deportes">Club de Deportes</option>
              <option value="idiomas">Club de Idiomas</option>
              <option value="matematica">Club de Matemática</option>
              <option value="musica">Club de Música</option>
              <option value="programacion">Club de Programación</option>
              <option value="starwars">Club Star Wars</option>
              <option value="otro">Otro club</option>
              <option value="ninguno">No estoy interesado</option>
            </select>
          </div>
          <div style="display: none; margin-top: 10px;" id="intereses-buttons">
            <button onclick="saveField('intereses')" style="background: #22c55e; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin-right: 10px; cursor: pointer;">Guardar</button>
            <button onclick="cancelEdit('intereses')" style="background: #ef4444; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Cancelar</button>
          </div>
        </div>

        <!-- Read-only fields -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 30px;">
          
          <!-- Birth Date -->
          <div style="padding: 15px; background: #1a1a1f; border-radius: 8px; border-left: 4px solid #f18b32;">
            <label style="color: #f18b32; font-weight: bold; display: block; margin-bottom: 5px;">
              <i class="fas fa-calendar" style="margin-right: 8px;"></i>Fecha de Nacimiento
            </label>
            <span id="fecha-nacimiento-display" style="color: #c9c9c9;">Cargando...</span>
          </div>

          <!-- Registration Date -->
          <div style="padding: 15px; background: #1a1a1f; border-radius: 8px; border-left: 4px solid #f18b32;">
            <label style="color: #f18b32; font-weight: bold; display: block; margin-bottom: 5px;">
              <i class="fas fa-clock" style="margin-right: 8px;"></i>Fecha de Inscripción
            </label>
            <span id="fecha-inscripcion-display" style="color: #c9c9c9;">Cargando...</span>
          </div>

          <!-- Credits Obtained -->
          <div style="padding: 15px; background: #1a1a1f; border-radius: 8px; border-left: 4px solid #f18b32;">
            <label style="color: #f18b32; font-weight: bold; display: block; margin-bottom: 5px;">
              <i class="fas fa-medal" style="margin-right: 8px;"></i>Créditos Obtenidos
            </label>
            <span id="creditos-obtenidos-display" style="color: #c9c9c9;">Cargando...</span>
          </div>
          
        </div>

      </div>

      <!-- Admin Panel (only visible for administrators) -->
      <div id="admin-panel" style="display: none; margin-top: 30px; padding: 30px; background: #1a1a1f; border-radius: 12px; border: 2px solid #ef4444;">
        <h3 style="color: #ef4444; margin-bottom: 20px; text-align: center;">
          <i class="fas fa-shield-alt" style="margin-right: 8px;"></i>Panel de Administrador
        </h3>
        <p style="color: #c9c9c9; text-align: center; margin-bottom: 25px;">
          Acceso completo a la gestión del sistema académico
        </p>
        
        <div class="row">
          <div class="col-md-6">
            <div style="background: #23232b; border-radius: 8px; padding: 20px; margin-bottom: 15px; border: 1px solid #4a4a55; text-align: center;">
              <i class="fas fa-book" style="color: #22c55e; font-size: 2.5em; margin-bottom: 15px;"></i>
              <h4 style="color: #22c55e; margin-bottom: 10px;">Gestión de Cursos</h4>
              <p style="color: #c9c9c9; margin-bottom: 15px; font-size: 0.9em;">
                Administrar el catálogo completo de cursos académicos
              </p>
              <a href="admin_cursos.html" style="background: #22c55e; color: white; text-decoration: none; padding: 10px 20px; border-radius: 6px; display: inline-block; font-weight: bold;">
                <i class="fas fa-cogs"></i> Administrar Cursos
              </a>
            </div>
          </div>
          
          <div class="col-md-6">
            <div style="background: #23232b; border-radius: 8px; padding: 20px; margin-bottom: 15px; border: 1px solid #4a4a55; text-align: center;">
              <i class="fas fa-users" style="color: #3b82f6; font-size: 2.5em; margin-bottom: 15px;"></i>
              <h4 style="color: #3b82f6; margin-bottom: 10px;">Gestión de Usuarios</h4>
              <p style="color: #c9c9c9; margin-bottom: 15px; font-size: 0.9em;">
                Administrar estudiantes, profesores y administradores
              </p>
              <a href="admin_lista_usuarios.html" style="background: #3b82f6; color: white; text-decoration: none; padding: 10px 20px; border-radius: 6px; display: inline-block; font-weight: bold;">
                <i class="fas fa-users-cog"></i> Administrar Usuarios
              </a>
            </div>
          </div>
        </div>
        
        <div class="row">
          <div class="col-md-12">
            <div style="background: #23232b; border-radius: 8px; padding: 20px; border: 1px solid #4a4a55; text-align: center;">
              <i class="fas fa-user-plus" style="color: #f59e0b; font-size: 2em; margin-bottom: 10px;"></i>
              <h5 style="color: #f59e0b; margin-bottom: 10px;">Registro de Nuevos Usuarios</h5>
              <p style="color: #c9c9c9; margin-bottom: 15px; font-size: 0.9em;">
                Crear nuevos usuarios en el sistema (estudiantes, profesores, administradores)
              </p>
              <a href="registro.html" style="background: #f59e0b; color: white; text-decoration: none; padding: 8px 16px; border-radius: 6px; display: inline-block; font-weight: bold;">
                <i class="fas fa-plus"></i> Registrar Usuario
              </a>
            </div>
          </div>
        </div>
        
        <div style="text-align: center; margin-top: 20px; padding-top: 20px; border-top: 1px solid #4a4a55;">
          <p style="color: #6b7280; font-size: 0.9em; margin: 0;">
            <i class="fas fa-info-circle" style="margin-right: 5px;"></i>
            Solo los administradores pueden acceder a estas funciones
          </p>
        </div>
      </div>

    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="config.js"></script>
  <script src="supabase.js"></script>
  </body>
</html>
